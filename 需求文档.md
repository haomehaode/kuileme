# 亏了么 - 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 产品定位
"亏了么"是一款面向股票投资亏损用户的社交社区应用，通过记录亏损、情感宣泄、社区互动、数据分析等功能，帮助用户面对和处理投资亏损带来的情绪，并提供回血、借贷等辅助服务。

### 1.2 目标用户
- 股票/基金/加密货币投资者
- 近期或长期遭受投资亏损的用户
- 需要情感宣泄和社区支持的投资者
- 希望通过数据分析复盘投资决策的用户

### 1.3 核心价值
- **情感支持**：提供亏损记录、宣泄、社区互动的平台
- **数据分析**：亏损统计、原因分析、净值走势可视化
- **辅助服务**：回血抽奖、借贷推荐等增值服务
- **游戏化体验**：等级系统、勋章墙、年度报告等

---

## 2. 功能模块

### 2.0 用户认证模块

#### 2.0.1 注册/登录流程
**功能描述**：用户首次使用需要注册/登录，支持多种登录方式

**页面元素**：
- **启动页**
  - 应用Logo和Slogan
  - 版本信息

- **登录页**
  - 应用Logo
  - 手机号登录（默认）
  - 微信登录按钮
  - 其他第三方登录（可选）
  - 用户协议和隐私政策勾选

- **注册页**
  - 手机号输入
  - 验证码输入
  - 密码设置（可选，支持免密登录）
  - 昵称设置（可跳过，后续补充）
  - 用户协议和隐私政策

**业务规则**：
- 支持手机号+验证码登录
- 支持微信一键登录
- 新用户注册后引导完善资料（可选）
- 首次登录引导新手教程
- 登录状态保持（Token机制）
- 支持退出登录

**数据流转**：
- 注册成功后创建用户记录
- 初始化用户数据（等级Lv.1、亏损等级"初入江湖"、回血金0等）
- 生成用户ID和基础配置

---

### 2.1 社区模块

#### 2.1.1 社区首页
**功能描述**：展示社区动态、亏损总览、风险提示

**页面元素**：
- **顶部导航栏**
  - 应用名称"亏了么" + "社区"
  - 通知图标（右上角）

- **亏损总览卡片**
  - 今日A股/港股总亏损（CNY）
  - 亏损金额（大号绿色数字）
  - 亏损百分比
  - 账户总回撤比
  - 近30日人均亏损

- **风险提示卡片**
  - 天台指数（拥挤程度）
  - 风险提示文案："今日亏损已达上限,天台风大,关灯吃面,不要冲动。"

- **内容筛选标签**
  - 热门吐槽（默认选中）
  - 深度套牢
  - 抄底失败
  - 机构受害
  - 支持标签切换筛选内容

- **社区帖子列表**
  - 帖子卡片包含：
    - 用户信息（头像、昵称、地区、发布时间）
    - 正文内容
    - 股票信息卡片（股票名称、买入价、当前价、亏损百分比、预估亏损）
    - 互动数据（评论数、点赞/心碎数、分享）
    - 更多操作菜单（三点图标）

- **底部导航栏**
  - 首页（选中）
  - 分析
  - 发布按钮（中央绿色圆形+号）
  - 圈子
  - 我的

**交互需求**：
- 支持下拉刷新
- 支持上拉加载更多
- 点击帖子进入详情页
- 点击标签切换筛选
- 点击发布按钮进入发布页面
- 点击通知图标进入通知中心

**数据流转**：
- 亏损总览数据：实时统计所有用户的当日亏损
- 天台指数：根据当日亏损用户比例和亏损金额计算
- 帖子列表：按时间/热度排序，支持标签筛选
- 数据更新：下拉刷新时重新获取最新数据

---

#### 2.1.2 帖子详情页
**功能描述**：展示帖子完整内容、评论列表、互动功能

**页面元素**：
- **顶部导航栏**
  - 返回按钮
  - 帖子标题或"亏损日记"
  - 分享按钮

- **帖子内容区**
  - 用户信息（头像、昵称、等级、地区、时间）
  - 正文内容
  - 股票信息卡片（如有）
  - 心理状态标签
  - 关联标签

- **互动数据区**
  - 点赞/心碎按钮（支持切换）
  - 评论按钮
  - 分享按钮
  - 数据统计（点赞数、评论数、分享数）

- **评论列表**
  - 评论输入框（底部固定）
  - 评论项（用户信息、评论内容、时间、点赞）
  - 支持回复评论
  - 支持点赞评论
  - 支持举报评论

- **相关推荐**
  - 相似亏损经历帖子
  - 同标签帖子

**业务规则**：
- 点赞/心碎互斥，只能选一个
- 评论支持@用户
- 评论字数限制200字
- 支持删除自己的评论
- 匿名帖子不显示用户真实信息
- 评论实时更新

**数据流转**：
- 加载帖子详情
- 加载评论列表（分页）
- 点赞/评论操作实时更新
- 互动数据同步到帖子列表

---

#### 2.1.3 通知中心
**功能描述**：展示系统通知、互动通知、系统消息

**页面元素**：
- **顶部导航栏**
  - 返回按钮
  - 页面标题："通知"
  - 全部已读按钮

- **通知分类标签**
  - 全部
  - 互动（点赞、评论、回复）
  - 系统（审核结果、活动通知）
  - 关注（关注的人发布新帖）

- **通知列表**
  - 通知类型图标
  - 通知内容
  - 时间戳
  - 未读标识（红点）
  - 跳转链接（点击进入相关页面）

**业务规则**：
- 通知实时推送
- 支持标记已读
- 支持全部已读
- 通知保留30天
- 点击通知跳转到对应页面

---

### 2.1.4 圈子/广场模块
**功能描述**：基于兴趣标签的社区圈子，用户可加入不同圈子

**页面元素**：
- **圈子列表**
  - 热门圈子推荐
  - 我加入的圈子
  - 圈子卡片（图标、名称、成员数、今日动态数）

- **圈子详情页**
  - 圈子信息（名称、描述、成员数）
  - 加入/退出按钮
  - 圈子内帖子列表
  - 圈子规则

**业务规则**：
- 用户可加入多个圈子
- 圈子帖子按时间/热度排序
- 支持创建圈子（需审核）

---

### 2.2 发布亏损日记模块

#### 2.2.1 发布页面
**功能描述**：用户记录亏损金额、心理状态、故事内容并发布

**页面元素**：
- **顶部导航栏**
  - 关闭按钮（X图标，左上角）
  - 页面标题："今天亏了多少?"（居中）
  - 发布按钮（右上角文本按钮）

- **亏损金额输入区**
  - 标签："输入亏损金额 (CNY)"
  - 输入框：带¥前缀，支持数字输入，保留两位小数
  - 默认值：0.00

- **心理状态选择区**
  - 标签："现在的心理状态"
  - 单选按钮组（四个选项）：
    - 微痛（裂开心形图标）
    - 大出血（悲伤表情图标）
    - 原地破产（骷髅头图标）
    - 灵魂出窍（波浪线图标，默认选中）

- **自嘲或吐槽输入区**
  - 标签："自嘲或吐槽"
  - 多行文本输入框
  - 占位符："在这里写下你的亏钱故事，让大家开心一下..."
  - 支持多行输入，建议字数限制500字

- **关联标的选择区**
  - 标签："关联标的"
  - 预设标签按钮（多选）：
    - 大盘A股
    - 纳斯达克
    - 币圈
    - 末日期权
    - 基金经理死对头
  - 自定义标签按钮："+ 自定义"
    - 点击后弹出输入框，允许用户输入自定义标签

- **匿名发布选项**
  - 文本："匿名发布 (更少尴尬)"
  - 切换开关（默认关闭）

- **主操作按钮**
  - 文本："发布日记并宣泄"
  - 样式：全宽、大尺寸、亮绿色背景
  - 位置：页面底部

**业务规则**：
- 亏损金额为必填项，必须大于0
- 心理状态为必填项
- 故事内容为可选，但建议填写
- 关联标签至少选择一个
- 提交前进行表单验证
- 提交成功后跳转到社区首页或帖子详情页
- 支持草稿保存（关闭时提示）

**数据字段**：
- 亏损金额（decimal）
- 心理状态（enum）
- 故事内容（text）
- 关联标签（array）
- 是否匿名（boolean）
- 发布时间（datetime）
- 用户ID（关联）

**数据流转**：
- 发布成功后：
  1. 创建亏损日记记录
  2. 更新用户统计数据（亏损动态数+1）
  3. 更新用户记录天数（如果当天首次发布）
  4. 检查并解锁相关勋章（如"首次发布"、"连续发布7天"等）
  5. 更新用户等级经验值
  6. 更新社区首页亏损总览数据
  7. 推送通知给关注用户（如开启）
  8. 跳转到帖子详情页或社区首页

**关联功能**：
- 发布后可选择是否分享到其他平台
- 发布后可获得回血金奖励（首次发布奖励、连续发布奖励等）
- 发布内容触发AI分析，用于后续复盘

---

### 2.3 存钱抽奖回血模块

#### 2.3.1 回血抽奖页面
**功能描述**：用户通过投入资金参与抽奖，获得回血金奖励

**页面元素**：
- **顶部导航栏**
  - 返回按钮（左箭头）
  - 页面标题："存钱抽奖回血"
  - 帮助按钮（问号图标）

- **GRAND RECOVERY POOL区域**
  - 标题："GRAND RECOVERY POOL"（巨额回血奖池）
  - 总奖池金额：¥10,000（大号金色数字）
  - 今日已送出回血金：¥3,420

- **标语区**
  - 主标题："股市绿了,这里是金色的"
  - 副标题："亏友们的最后一道防线"

- **用户中奖通知区**
  - 横向滚动通知条
  - 显示格式："亏友 张** 刚刚抽中了50元回血金"
  - 实时更新中奖信息

- **回血大转盘模块**
  - 转盘图片（显示概率、倍数、奖品数值）
  - 中央播放按钮图标
  - 标题："回血大转盘"
  - 操作说明："点击中心或下方按钮即可开始抽奖"

- **主要行动按钮**
  - 文本："投入1元 立即回血"
  - 样式：醒目的黄色长方形按钮

- **我的回血记录模块**
  - 标题："我的回血记录"
  - "查看全部"链接
  - 记录列表（最近两条）：
    - 记录类型（抽中回血金/参与投入）
    - 时间戳
    - 金额（+绿色表示收入，-深色表示支出）
    - 图标标识

- **账户余额及操作区**
  - 当前余额显示：¥128.50
  - 充值按钮（黄色）
  - 提现按钮（黄色）

**业务规则**：
- 每次抽奖需投入1元（可配置）
- 抽奖结果包括：回血金金额、概率倍数等
- 中奖金额直接进入账户余额
- 支持充值功能（最低充值金额限制）
- 支持提现功能（最低提现金额限制，可能需要审核）
- 回血记录永久保存
- 转盘抽奖有概率控制机制

**数据字段**：
- 用户余额（decimal）
- 抽奖记录（array）
  - 类型（抽中/投入）
  - 金额
  - 时间
- 充值记录（array）
- 提现记录（array）

**数据流转**：
- 抽奖流程：
  1. 检查余额是否充足
  2. 扣除投入金额
  3. 根据概率算法计算中奖结果
  4. 如果中奖，增加回血金到余额
  5. 记录抽奖记录
  6. 更新奖池数据（总奖池-中奖金额，今日已送出+中奖金额）
  7. 如果中大奖，推送通知并可能解锁勋章
  8. 更新用户统计数据
  9. 检查并解锁相关勋章（如"首次抽奖"、"累计抽奖10次"等）

- 充值流程：
  1. 选择充值金额
  2. 跳转支付（微信/支付宝）
  3. 支付成功后回调
  4. 增加余额
  5. 记录充值记录
  6. 推送充值成功通知

- 提现流程：
  1. 输入提现金额（需≥最低提现金额）
  2. 验证提现密码/身份
  3. 提交提现申请
  4. 审核（自动/人工）
  5. 审核通过后扣除余额
  6. 记录提现记录
  7. 推送提现成功通知

**关联功能**：
- 回血金可用于：
  - 参与抽奖
  - 兑换礼品（回血中心）
  - 提现到银行卡
- 抽奖次数限制（每日最多N次，防止过度消费）
- 充值有奖励活动（首次充值送、充值满额送等）

---

#### 2.3.2 回血中心（积分兑换）
**功能描述**：用户使用回血金或积分兑换礼品

**页面元素**：
- **顶部导航栏**
  - 返回按钮
  - 页面标题："回血中心"
  - 积分余额显示

- **积分获取规则**
  - 每日签到：+10积分
  - 发布日记：+20积分
  - 评论互动：+5积分
  - 连续签到：额外奖励

- **礼品分类**
  - 实物礼品（需要更多积分）
  - 虚拟礼品（优惠券、会员等）
  - 限时特惠

- **礼品列表**
  - 礼品图片
  - 礼品名称
  - 所需积分/回血金
  - 库存数量
  - 兑换按钮

- **我的兑换记录**
  - 已兑换礼品列表
  - 物流信息（实物礼品）
  - 兑换时间

**业务规则**：
- 积分和回血金可混合使用
- 兑换后扣除对应积分/回血金
- 实物礼品需要填写收货地址
- 虚拟礼品即时到账
- 支持取消兑换（未发货前）

---

### 2.4 紧急救助站模块

#### 2.4.1 救助站首页
**功能描述**：为用户提供借贷产品推荐和额度管理

**页面元素**：
- **顶部导航栏**
  - 返回按钮
  - 页面标题："紧急救助站"
  - 分享按钮

- **亏友专属额度区域**
  - 标题："亏友专属额度 (元)"
  - 额度显示：200,000（大号绿色数字）
  - 提示标签："急速审核·凭亏损截图提额"
    - 支持上传亏损截图
    - 快速审核机制

- **精选回血方案区域**
  - 标题："精选回血方案"
  - "更多借款"链接
  - 方案卡片列表（三种）：
    
    **方案一：闪电速贷**
    - 特点标签：审核快、无视黑名单
    - 描述：最高3万 | 1分钟审核
    - 操作按钮："去申请"（绿色）
    - 图标：闪电图标
    
    **方案二：回血金库**
    - 特点标签：利息低、大额专享
    - 描述：日利率 0.02%起
    - 操作按钮："去借款"（绿色）
    - 图标：钱包图标
    
    **方案三：紧急救助金**
    - 特点标签：门槛低、身份证即贷
    - 描述：不看征信 | 全天候审核
    - 操作按钮："去看看"（绿色）
    - 图标：医疗十字盾牌图标

- **风险提示与声明**
  - 标题："理性消费 拒绝盲目借贷"（带信息图标）
  - 详细声明："本平台仅提供推荐服务，实际额度以机构审批为准。请根据个人还款能力合理安排，逾期将产生罚息并影响征信。"

- **主操作按钮**
  - 文本："立即申请回血"
  - 样式：宽大绿色按钮

- **底部导航栏**
  - 广场
  - 亏损墙
  - 发帖（中央+号）
  - 救助站（选中，绿色高亮）
  - 我的

**业务规则**：
- 用户分层：根据亏损记录提供专属额度
- 额度提升：支持上传亏损截图，审核后提升额度
- 产品推荐：根据用户画像推荐合适的借贷产品
- 跳转逻辑：点击产品卡片跳转到第三方机构页面或申请流程
- 合规要求：必须显示风险提示和免责声明
- 审核机制：亏损截图审核（自动/人工）

**数据字段**：
- 用户专属额度（decimal）
- 亏损截图（array，图片URL）
- 审核状态（enum：待审核/已通过/已拒绝）
- 产品推荐记录（array）

**数据流转**：
- 额度提升流程：
  1. 用户上传亏损截图（支持多张）
  2. 图片上传到OSS
  3. 创建审核记录
  4. 系统自动识别截图内容（OCR+AI识别）
  5. 人工复核（如需要）
  6. 审核通过后计算提升额度（基于亏损金额比例）
  7. 更新用户专属额度
  8. 推送审核结果通知
  9. 记录额度变更历史

- 产品推荐逻辑：
  1. 分析用户画像（亏损金额、亏损等级、活跃度等）
  2. 匹配推荐算法
  3. 推荐3-5个合适的产品
  4. 记录推荐历史
  5. 跟踪用户点击和申请行为

**关联功能**：
- 额度提升后可解锁更多借贷产品
- 申请借贷产品后记录申请状态
- 成功申请后可获得回血金奖励

---

### 2.5 个人中心模块

#### 2.5.1 个人中心首页
**功能描述**：展示用户资料、统计数据、功能入口

**页面元素**：
- **顶部导航栏**
  - 设置图标（齿轮，左上角）
  - 页面标题："个人中心"
  - 通知图标（铃铛，右上角）

- **用户资料区域**
  - 用户头像（圆形，带绿色发光边框）
  - 用户等级：Lv.88（绿色标签）
  - 用户昵称："资深韭皇"（带绿色认证图标）
  - 用户ID：9527
  - 亏损等级："极度深寒"
  - 个人签名："只要我不卖,我就没亏。"
  - 编辑资料按钮（绿色，全宽）

- **统计数据卡片区**
  - 三个并排卡片：
    - 记录天数：256（带日历图标）
    - 亏损动态：1,024（带消息图标）
    - 回血金：¥0.00（带钱币爱心图标）

- **2023年度亏损报告**
  - 横幅区域（深色背景，光影效果）
  - 主标题："2023年度亏损报告"
  - 副标题："回顾你这一年跌宕起伏的韭菜生涯"
  - 操作按钮："立即查看"（绿色）

- **功能入口网格区（2x2）**
  - **我的日记**：书本图标，"记录心碎瞬间"
  - **我的动态**：纸飞机图标，"围观与互勉"
  - **回血中心**：钞票图标，"积分兑换好礼"
  - **勋章墙**：星形图标，"已解锁 12 枚"

- **底部导航栏**
  - 首页
  - 行情
  - 发泄（中央大圆形绿色按钮，带光晕）
  - 广场
  - 我的（选中，绿色高亮）

- **发泄功能区扩展**
  - 四个圆形快捷入口：
    - 资深嫩韭（叶子图标）
    - 抄底失败（折线图下跌图标）
    - 钻石手(碎)（破碎钻石图标）
    - 百倍币梦碎（火箭破碎图标）

**业务规则**：
- 用户等级系统：根据活跃度、记录天数等计算等级
- 亏损等级系统：根据总亏损金额、回撤比例等划分等级
- 统计数据实时更新
- 年度报告：每年生成一次，包含数据分析、可视化图表
- 勋章系统：完成特定任务解锁勋章
- 回血中心：积分兑换礼品功能

**数据字段**：
- 用户基本信息
  - 头像URL
  - 昵称
  - 用户ID
  - 等级
  - 亏损等级
  - 个人签名
- 统计数据
  - 记录天数
  - 亏损动态数
  - 回血金余额
- 勋章数据（array）
- 年度报告数据

**数据流转**：
- 用户等级计算：
  - 基础经验：每日登录+10，发布日记+50，评论+5，点赞+2
  - 连续签到额外奖励
  - 等级经验值累计，达到阈值自动升级
  - 升级时推送通知，可能解锁新功能

- 亏损等级计算：
  - 根据累计亏损金额和回撤比例
  - 等级：初入江湖 → 小有亏损 → 深度套牢 → 极度深寒 → 天台边缘
  - 实时更新，影响专属额度计算

---

#### 2.5.2 我的日记
**功能描述**：查看用户发布的所有亏损日记

**页面元素**：
- **顶部导航栏**
  - 返回按钮
  - 页面标题："我的日记"
  - 筛选按钮（按时间/金额/心理状态）

- **日记列表**
  - 日记卡片（日期、亏损金额、心理状态、内容预览）
  - 支持编辑（24小时内）
  - 支持删除
  - 支持分享

- **统计信息**
  - 总发布数
  - 总亏损金额
  - 平均每日亏损
  - 最痛的一天

**业务规则**：
- 仅显示自己的日记
- 支持按条件筛选
- 支持导出日记（PDF/Excel）

---

#### 2.5.3 我的动态
**功能描述**：查看用户在社区的所有互动记录

**页面元素**：
- **动态分类**
  - 我发布的
  - 我评论的
  - 我点赞的
  - 我分享的

- **动态列表**
  - 动态类型图标
  - 动态内容
  - 时间戳
  - 跳转链接

**业务规则**：
- 实时同步互动数据
- 支持快速跳转到原帖

---

#### 2.5.4 勋章墙
**功能描述**：展示用户已解锁和未解锁的勋章

**页面元素**：
- **勋章分类**
  - 全部
  - 已解锁
  - 未解锁
  - 稀有勋章

- **勋章网格**
  - 勋章图标（已解锁显示彩色，未解锁显示灰色）
  - 勋章名称
  - 解锁条件
  - 解锁时间（已解锁）
  - 进度条（未解锁，显示完成进度）

- **勋章详情**
  - 点击查看详情
  - 解锁条件说明
  - 解锁用户数（稀有度）

**业务规则**：
- 解锁勋章时推送通知
- 稀有勋章在个人资料中展示
- 支持分享勋章成就

**勋章类型示例**：
- 首次发布：发布第一条日记
- 连续发布7天：连续7天发布日记
- 深度套牢：单次亏损超过1万
- 回血达人：累计回血金超过1000
- 社区活跃：评论数超过100
- 年度坚持：一年内发布超过365条

---

#### 2.5.5 年度亏损报告
**功能描述**：生成用户年度亏损数据报告

**页面元素**：
- **报告封面**
  - 年度标题（如"2023年度亏损报告"）
  - 用户昵称
  - 生成时间

- **数据概览**
  - 年度总亏损
  - 年度跌幅
  - 发布日记数
  - 最痛的一天
  - 最痛的一只股票

- **可视化图表**
  - 月度亏损趋势图
  - 亏损原因分布饼图
  - 心理状态变化曲线
  - 回血金获取统计

- **情感化总结**
  - AI生成的年度总结文案
  - 关键词云图
  - 成长轨迹

- **分享功能**
  - 生成报告图片
  - 分享到朋友圈/微博
  - 保存到相册

**业务规则**：
- 每年1月1日自动生成上一年报告
- 支持手动生成
- 报告数据加密存储
- 支持查看历史年度报告

**数据流转**：
1. 统计年度所有亏损日记
2. 计算各项统计数据
3. 调用AI生成总结文案
4. 生成可视化图表
5. 渲染报告页面
6. 支持导出PDF/图片

---

#### 2.5.6 设置页面
**功能描述**：应用设置和账户管理

**页面元素**：
- **账户设置**
  - 修改昵称
  - 修改头像
  - 修改签名
  - 修改密码
  - 绑定手机号
  - 绑定微信

- **隐私设置**
  - 谁可以看我的日记（公开/仅关注/私密）
  - 是否允许被搜索
  - 是否允许收到通知
  - 匿名发布默认设置

- **通知设置**
  - 互动通知开关
  - 系统通知开关
  - 活动通知开关
  - 推送时间设置

- **其他设置**
  - 清除缓存
  - 关于我们
  - 用户协议
  - 隐私政策
  - 意见反馈
  - 退出登录

---

### 2.6 投资复盘模块

#### 2.6.1 复盘页面
**功能描述**：展示用户亏损统计、净值走势、原因分析，并提供留言功能

**页面元素**：
- **顶部导航栏**
  - 返回按钮
  - 页面标题："投资痛定思痛复盘"
  - 分享按钮

- **本月亏损总额区域**
  - 标题："本月亏损总额"
  - 亏损金额：-¥142,500.00（大号橘红色）
  - 跌幅标签："↘跌幅 35.8%"（浅橘色背景）
  - 情感化标题："心碎曲线图"
  - 安慰文案："只要我不卖，这就只是数字..."

- **近一个月净值走势图**
  - 标题："近一个月净值走势"
  - 折线图（显示净值随时间变化）
  - X轴标注点：
    - 月初(满怀希望)
    - 月中(倔强坚持)
    - 现在(心如死灰)（橘红色标注）
  - 图表图标（右上角）

- **亏损原因统计区域**
  - 标题："亏损原因统计"
  - 副标题："大数据比你更懂你的鲁莽"
  - 三个并列卡片：
    - **追涨杀跌**：45%（火箭图标，蓝色进度条）
    - **小道消息**：30%（扩音器图标，紫色进度条）
    - **幻觉抄底(接飞刀)**：25%（绿色圆点图标，绿色进度条）
      - 额外文案："我觉得到底是底了"

- **给未来的自己留言区域**
  - 标题："给未来的自己留言"（带铅笔图标）
  - 多行文本输入框
  - 占位符："在这里写下你的血泪教训...例如:再相信群友我是狗。"
  - 提示文字："此留言将被存入"悔过书"加密档案，下次冲动时自动弹出。"（带锁形图标）

- **底部操作按钮**
  - 文本："封印这段痛苦"（带魔法棒图标）
  - 样式：宽大蓝色圆角按钮

- **底部导航栏**
  - 社区
  - 复盘（选中，绿色指示条）
  - 中央大加号按钮（蓝色圆形）
  - 宣泄
  - 我的

- **应用版权信息**
  - "POWERED BY KUELEMA COMMUNITY"

**业务规则**：
- 亏损统计：按月/按年统计总亏损和跌幅
- 净值走势：基于用户记录的交易数据生成图表
- 亏损原因分析：通过AI/规则引擎分析用户行为，统计各类原因占比
- 留言功能：
  - 支持多行文本输入
  - 加密存储（"悔过书"档案）
  - 触发机制：检测到用户有冲动行为（如大额买入、频繁交易）时自动弹出
- 封印功能：保存复盘记录，标记为已完成复盘

**数据字段**：
- 复盘记录
  - 统计周期（月/年）
  - 亏损总额
  - 跌幅百分比
  - 净值走势数据（array）
  - 亏损原因统计（object）
- 留言数据
  - 留言内容（加密存储）
  - 创建时间
  - 触发条件
  - 触发记录（array）

**数据流转**：
- 复盘生成流程：
  1. 用户进入复盘页面
  2. 选择统计周期（本月/本年）
  3. 系统统计该周期内所有亏损日记
  4. 计算总亏损和跌幅
  5. 基于日记数据生成净值走势（假设初始净值为100，每次亏损按比例减少）
  6. AI分析亏损原因：
     - 分析日记内容关键词（追涨、杀跌、抄底、消息等）
     - 分析交易频率（频繁交易→追涨杀跌）
     - 分析亏损金额波动（大波动→情绪化交易）
     - 统计各类原因占比
  7. 渲染图表和数据
  8. 用户输入留言
  9. 加密存储留言
  10. 保存复盘记录
  11. 更新用户统计数据
  12. 可能解锁"复盘达人"勋章

- 留言触发机制：
  1. 系统监控用户行为
  2. 触发条件：
     - 单次发布亏损金额 > 历史平均亏损的2倍
     - 24小时内发布日记超过3次
     - 连续多天发布大额亏损日记
  3. 检测到触发条件
  4. 弹出"悔过书"弹窗
  5. 显示历史留言内容
  6. 用户可选择：
     - 查看并继续操作
     - 取消当前操作
     - 编辑留言

**关联功能**：
- 复盘数据用于年度报告生成
- 复盘数据影响用户亏损等级计算
- 留言触发记录用于分析用户行为模式

---

#### 2.6.2 行情/分析模块
**功能描述**：展示市场行情和用户投资分析

**页面元素**：
- **市场概览**
  - A股指数（上证、深证、创业板）
  - 港股指数
  - 美股指数（可选）
  - 涨跌幅显示

- **我的持仓分析**（基于用户发布的日记）
  - 持仓股票列表
  - 总盈亏统计
  - 持仓分布（饼图）
  - 盈亏趋势

- **热门亏损股票排行**
  - 社区内提及最多的亏损股票
  - 平均亏损金额
  - 亏损用户数

- **市场情绪指数**
  - 基于社区用户心理状态计算
  - 情绪趋势图

**业务规则**：
- 行情数据实时更新（对接第三方API）
- 持仓分析基于用户发布的日记数据
- 支持添加自选股票

---

## 3. 数据模型

### 3.1 用户模型 (User)
```json
{
  "id": "用户ID",
  "nickname": "昵称",
  "avatar": "头像URL",
  "level": "等级（如Lv.88）",
  "lossLevel": "亏损等级（如：极度深寒）",
  "signature": "个人签名",
  "balance": "回血金余额",
  "exclusiveLimit": "专属额度",
  "recordDays": "记录天数",
  "lossPosts": "亏损动态数",
  "medals": ["勋章ID数组"],
  "createdAt": "注册时间",
  "updatedAt": "更新时间"
}
```

### 3.2 亏损日记模型 (LossDiary)
```json
{
  "id": "日记ID",
  "userId": "用户ID",
  "amount": "亏损金额",
  "mood": "心理状态（微痛/大出血/原地破产/灵魂出窍）",
  "content": "故事内容",
  "tags": ["关联标签数组"],
  "isAnonymous": "是否匿名",
  "stockInfo": {
    "name": "股票名称",
    "code": "股票代码",
    "buyPrice": "买入价",
    "currentPrice": "当前价",
    "lossPercent": "亏损百分比",
    "estimatedLoss": "预估亏损"
  },
  "interactions": {
    "comments": "评论数",
    "likes": "点赞/心碎数",
    "shares": "分享数"
  },
  "createdAt": "发布时间"
}
```

### 3.3 回血记录模型 (RecoveryRecord)
```json
{
  "id": "记录ID",
  "userId": "用户ID",
  "type": "类型（抽中回血金/参与投入/充值/提现）",
  "amount": "金额",
  "description": "描述",
  "createdAt": "时间"
}
```

### 3.4 复盘记录模型 (ReviewRecord)
```json
{
  "id": "复盘ID",
  "userId": "用户ID",
  "period": "统计周期（月/年）",
  "totalLoss": "总亏损",
  "lossPercent": "跌幅百分比",
  "netValueTrend": ["净值走势数据"],
  "lossReasons": {
    "追涨杀跌": "百分比",
    "小道消息": "百分比",
    "幻觉抄底": "百分比"
  },
  "messageToFuture": "给未来的留言（加密）",
  "sealedAt": "封印时间",
  "createdAt": "创建时间"
}
```

### 3.5 勋章模型 (Medal)
```json
{
  "id": "勋章ID",
  "name": "勋章名称",
  "icon": "图标URL",
  "description": "描述",
  "unlockCondition": "解锁条件",
  "rarity": "稀有度"
}
```

### 3.6 评论模型 (Comment)
```json
{
  "id": "评论ID",
  "postId": "帖子ID",
  "userId": "用户ID",
  "parentId": "父评论ID（回复时）",
  "content": "评论内容",
  "likes": "点赞数",
  "createdAt": "评论时间",
  "updatedAt": "更新时间"
}
```

### 3.7 互动模型 (Interaction)
```json
{
  "id": "互动ID",
  "userId": "用户ID",
  "targetType": "目标类型（post/comment）",
  "targetId": "目标ID",
  "actionType": "操作类型（like/heart/share）",
  "createdAt": "操作时间"
}
```

### 3.8 通知模型 (Notification)
```json
{
  "id": "通知ID",
  "userId": "用户ID",
  "type": "通知类型（like/comment/reply/system）",
  "title": "通知标题",
  "content": "通知内容",
  "relatedId": "关联ID",
  "isRead": "是否已读",
  "createdAt": "创建时间"
}
```

### 3.9 积分记录模型 (PointsRecord)
```json
{
  "id": "记录ID",
  "userId": "用户ID",
  "type": "类型（签到/发布/评论/兑换）",
  "points": "积分变化（正数增加，负数减少）",
  "description": "描述",
  "createdAt": "时间"
}
```

### 3.10 用户等级模型 (UserLevel)
```json
{
  "level": "等级",
  "name": "等级名称",
  "minExp": "最低经验值",
  "maxExp": "最高经验值",
  "privileges": ["特权列表"]
}
```

---

## 4. 核心业务流程

### 4.1 发布亏损日记流程
1. 用户点击发布按钮
2. 进入发布页面
3. 填写亏损金额（必填）
4. 选择心理状态（必填）
5. 输入故事内容（可选）
6. 选择关联标签（至少一个）
7. 选择是否匿名
8. 点击"发布日记并宣泄"
9. 表单验证
10. 提交到服务器
11. 返回社区首页，显示新发布的帖子

### 4.2 抽奖回血流程
1. 用户进入回血抽奖页面
2. 查看奖池信息和历史中奖记录
3. 点击"投入1元 立即回血"
4. 检查账户余额是否充足
5. 如果不足，引导充值
6. 扣除1元，启动转盘抽奖动画
7. 显示抽奖结果
8. 如果中奖，增加回血金到账户余额
9. 更新回血记录
10. 更新奖池信息

### 4.3 额度提升流程
1. 用户进入紧急救助站
2. 查看当前专属额度
3. 点击"凭亏损截图提额"
4. 上传亏损截图（支持多张）
5. 提交审核
6. 系统/人工审核
7. 审核通过后提升额度
8. 通知用户额度更新

### 4.4 复盘生成流程
1. 用户进入复盘页面
2. 系统统计本月/本年亏损数据
3. 生成净值走势图数据
4. AI分析亏损原因并统计占比
5. 展示统计结果和图表
6. 用户输入给未来的留言
7. 点击"封印这段痛苦"
8. 加密存储留言
9. 保存复盘记录

### 4.5 留言触发流程
1. 系统检测用户行为（大额买入、频繁交易等）
2. 判断是否符合触发条件
3. 如果符合，弹出"悔过书"留言
4. 用户查看历史留言
5. 用户可选择忽略或重新编辑

### 4.6 用户完整生命周期流程
1. **新用户注册/登录**
   - 选择登录方式（手机号/微信）
   - 完成注册流程
   - 初始化用户数据（等级Lv.1、亏损等级"初入江湖"）
   - 引导新手教程

2. **首次使用引导**
   - 介绍核心功能（发布日记、社区互动、回血抽奖）
   - 引导发布第一条日记（可选）
   - 解锁"首次发布"勋章

3. **日常使用循环**
   - **记录亏损**：发布亏损日记
     - 填写亏损信息
     - 选择心理状态
     - 发布到社区
     - 获得积分奖励
     - 更新统计数据
   
   - **社区互动**：浏览、点赞、评论
     - 浏览社区帖子
     - 点赞/心碎互动
     - 评论交流
     - 获得积分奖励
     - 可能收到回复通知
   
   - **数据分析**：查看复盘
     - 查看月度/年度复盘
     - 了解亏损原因
     - 输入给未来的留言
     - 封印复盘记录
   
   - **回血活动**：抽奖、兑换
     - 充值参与抽奖
     - 获得回血金
     - 兑换礼品
     - 提现（可选）

4. **成长体系**
   - 每日签到获得积分
   - 发布日记获得经验值
   - 互动获得经验值
   - 等级提升解锁新功能
   - 解锁勋章获得成就感

5. **年度总结**
   - 自动生成年度报告
   - 回顾一年亏损历程
   - 分享年度报告
   - 制定新年目标

### 4.7 数据同步流程
1. **用户操作触发数据更新**
   - 发布日记 → 更新日记表、用户统计、社区总览
   - 点赞评论 → 更新互动表、通知表、帖子统计
   - 抽奖充值 → 更新余额、记录表、积分表

2. **定时任务更新**
   - 每日0点：更新记录天数、重置签到
   - 每日0点：计算天台指数、更新风险提示
   - 每周：生成周报数据
   - 每月1日：生成月度复盘数据
   - 每年1月1日：生成年度报告

3. **实时推送**
   - 互动通知（点赞、评论、回复）
   - 系统通知（审核结果、活动通知）
   - 数据更新通知（等级提升、勋章解锁）

### 4.8 页面跳转关系图
```
启动页
  ↓
登录/注册页
  ↓
社区首页（默认）
  ├─→ 帖子详情页
  │     ├─→ 评论列表
  │     └─→ 用户主页
  ├─→ 发布日记页
  │     └─→ 发布成功 → 帖子详情页
  └─→ 通知中心

底部导航栏
  ├─ 首页（社区首页）
  ├─ 分析（行情/复盘）
  │     ├─→ 复盘页面
  │     │     └─→ 年度报告
  │     └─→ 行情页面
  ├─ 发布（发布日记页）
  ├─ 圈子（圈子列表）
  │     └─→ 圈子详情
  └─ 我的（个人中心）
        ├─→ 我的日记
        ├─→ 我的动态
        ├─→ 回血中心
        │     └─→ 回血抽奖页
        │           ├─→ 充值页
        │           └─→ 提现页
        ├─→ 勋章墙
        ├─→ 年度报告
        ├─→ 设置页
        └─→ 紧急救助站
              └─→ 额度提升页
```

---

## 5. 技术需求

### 5.1 前端技术栈
- 移动端框架：React Native / Flutter / 原生开发
- UI组件库：Ant Design Mobile / Material Design
- 状态管理：Redux / MobX
- 图表库：ECharts / Chart.js
- 图片处理：图片上传、压缩、预览

### 5.2 后端技术栈
- 后端框架：Node.js / Python Django / Java Spring Boot
- 数据库：MySQL / PostgreSQL（关系型）+ Redis（缓存）
- 文件存储：OSS / S3（图片、截图存储）
- 加密存储：AES加密（留言内容）
- AI分析：机器学习模型（亏损原因分析）

### 5.3 第三方服务
- 支付服务：微信支付 / 支付宝（充值、提现）
- 短信服务：验证码、通知
- 推送服务：消息推送
- 借贷产品对接：第三方API接口

---

## 6. 非功能性需求

### 6.1 性能要求
- 页面加载时间 < 2秒
- 图片加载优化（懒加载、压缩）
- 列表滚动流畅（虚拟滚动）
- API响应时间 < 500ms

### 6.2 安全要求
- 用户数据加密存储
- 敏感信息（留言）加密
- 支付安全（HTTPS、签名验证）
- 防刷机制（抽奖、额度提升）

### 6.3 合规要求
- 金融产品推荐需明确标注风险提示
- 借贷产品需符合监管要求
- 用户隐私保护（GDPR、个人信息保护法）
- 内容审核机制（社区帖子）

### 6.4 可用性要求
- 支持深色模式
- 响应式设计（适配不同屏幕尺寸）
- 无障碍访问支持
- 错误提示友好明确

---

## 7. 开发优先级

### Phase 1 - MVP（核心功能）- 4周
**目标**：完成核心闭环，用户可以记录亏损、浏览社区、基本互动

1. **用户认证系统**（3天）
   - 手机号登录/注册
   - Token机制
   - 用户基础信息管理

2. **发布亏损日记**（5天）
   - 发布页面UI
   - 表单验证
   - 数据提交和存储
   - 基础股票信息关联（可选）

3. **社区首页**（5天）
   - 帖子列表展示
   - 下拉刷新/上拉加载
   - 标签筛选
   - 基础互动（点赞）

4. **帖子详情页**（3天）
   - 详情展示
   - 评论列表
   - 评论发布

5. **个人中心基础**（3天）
   - 用户资料展示
   - 基础统计数据
   - 我的日记列表

6. **数据统计基础**（3天）
   - 用户统计数据计算
   - 社区总览数据计算
   - 数据更新机制

7. **通知系统基础**（3天）
   - 通知列表
   - 基础推送
   - 已读标记

### Phase 2 - 增强功能 - 3周
**目标**：完善用户体验，增加游戏化元素

1. **回血抽奖功能**（5天）
   - 抽奖页面UI
   - 转盘动画
   - 概率算法
   - 充值/提现流程
   - 回血记录

2. **复盘功能（基础版）**（5天）
   - 复盘页面UI
   - 数据统计和图表
   - 基础亏损原因分析（规则引擎）
   - 留言功能（加密存储）

3. **勋章系统**（3天）
   - 勋章数据模型
   - 解锁逻辑
   - 勋章墙展示
   - 解锁通知

4. **用户等级系统**（3天）
   - 经验值计算
   - 等级升级逻辑
   - 等级展示

5. **积分系统**（2天）
   - 积分获取规则
   - 积分记录
   - 积分展示

### Phase 3 - 增值服务 - 3周
**目标**：增加高级功能和增值服务

1. **紧急救助站**（5天）
   - 额度展示和管理
   - 截图上传和审核
   - 产品推荐列表
   - 跳转逻辑

2. **回血中心（积分兑换）**（3天）
   - 礼品列表
   - 兑换流程
   - 兑换记录

3. **年度报告**（5天）
   - 数据统计和计算
   - 报告生成
   - 可视化图表
   - 分享功能

4. **AI亏损原因分析**（5天）
   - 文本分析（关键词提取）
   - 行为模式识别
   - 原因分类和统计
   - 结果展示

5. **行情/分析模块**（3天）
   - 行情数据对接
   - 持仓分析
   - 市场情绪指数

### Phase 4 - 优化迭代 - 持续
**目标**：性能优化、用户体验优化、新功能扩展

1. **性能优化**（持续）
   - 图片懒加载和压缩
   - 列表虚拟滚动
   - API响应优化
   - 缓存策略

2. **用户体验优化**（持续）
   - 动画效果
   - 交互优化
   - 错误处理
   - 加载状态

3. **新功能扩展**（按需求）
   - 圈子功能
   - 关注系统
   - 私信功能
   - 更多游戏化元素

4. **社区运营功能**（按需求）
   - 内容审核系统
   - 用户举报机制
   - 运营后台
   - 数据统计后台

---

## 8. 完整闭环流程说明

### 8.1 新用户完整流程
1. **注册/登录** → 创建账户，初始化数据
2. **新手引导** → 了解核心功能
3. **首次发布** → 发布第一条亏损日记，获得奖励
4. **社区互动** → 浏览他人帖子，点赞评论，获得积分
5. **查看复盘** → 了解自己的亏损情况
6. **参与回血** → 充值抽奖，获得回血金
7. **兑换礼品** → 使用回血金/积分兑换
8. **成长升级** → 持续使用，等级提升，解锁勋章
9. **年度总结** → 查看年度报告，回顾一年历程

### 8.2 数据流转闭环
```
用户操作
  ↓
数据更新（实时）
  ↓
统计计算（定时/实时）
  ↓
展示更新（前端刷新）
  ↓
触发通知（如需要）
  ↓
用户反馈（继续操作）
```

### 8.3 功能关联闭环
- **发布日记** → 更新统计 → 影响等级 → 解锁勋章 → 获得积分 → 可兑换礼品
- **社区互动** → 获得积分 → 提升等级 → 解锁功能 → 更多互动机会
- **回血抽奖** → 获得回血金 → 可提现/兑换 → 提升体验 → 增加粘性
- **复盘分析** → 了解问题 → 改进行为 → 减少亏损 → 更好的复盘数据

### 8.4 用户留存机制
1. **每日签到**：连续签到获得更多奖励
2. **任务系统**：完成每日/每周任务获得奖励
3. **等级系统**：持续使用提升等级，解锁特权
4. **勋章收集**：完成各种成就解锁勋章
5. **社区互动**：关注、点赞、评论建立社交关系
6. **数据沉淀**：长期使用积累数据，形成年度报告
7. **情感连接**：通过记录和分享建立情感连接

---

## 9. 待确认事项

1. **用户认证方式**：手机号/微信/其他第三方登录？
2. **支付方式**：支持哪些支付渠道？提现是否需要审核？
3. **借贷产品**：是否真实对接第三方机构，还是仅展示？
4. **内容审核**：是否需要人工审核社区内容？
5. **数据来源**：股票价格数据来源？净值计算方式？
6. **AI分析**：亏损原因分析的准确度要求？是否需要人工标注训练数据？
7. **匿名机制**：匿名发布的具体实现方式（完全匿名/部分匿名）？
8. **触发机制**：留言自动弹出的具体触发条件定义？
9. **抽奖概率**：转盘各奖项的中奖概率配置？
10. **等级体系**：等级数量、每级所需经验值、等级特权？
11. **勋章体系**：勋章总数、解锁条件、稀有度划分？
12. **积分规则**：各项操作的积分奖励标准？
13. **回血金规则**：回血金获取途径、使用限制、提现规则？

---

## 10. 附录

### 10.1 术语表
- **亏友**：遭受投资亏损的用户
- **回血**：通过抽奖、活动等方式获得资金补偿
- **韭菜**：投资术语，指容易被割的投资者（自嘲用语）
- **钻石手**：投资术语，指长期持有不卖（这里指失败）
- **天台指数**：反映用户亏损情绪的指标

### 10.2 参考设计图
- 社区首页设计图
- 发布亏损日记设计图
- 存钱抽奖回血设计图
- 紧急救助站设计图
- 个人中心设计图
- 投资复盘设计图

### 10.3 关键业务规则汇总

#### 10.3.1 用户等级计算规则
- 每日登录：+10经验
- 发布日记：+50经验
- 评论：+5经验
- 点赞：+2经验
- 连续签到：额外+20经验（第7天+50经验）
- 等级升级所需经验：Lv.N = N × 1000（可调整）

#### 10.3.2 亏损等级划分规则
- 初入江湖：累计亏损 < 1,000元
- 小有亏损：1,000元 ≤ 累计亏损 < 10,000元
- 深度套牢：10,000元 ≤ 累计亏损 < 100,000元
- 极度深寒：100,000元 ≤ 累计亏损 < 1,000,000元
- 天台边缘：累计亏损 ≥ 1,000,000元

#### 10.3.3 积分获取规则
- 每日签到：+10积分
- 发布日记：+20积分
- 评论：+5积分
- 点赞：+2积分
- 连续签到7天：额外+50积分
- 首次发布：+100积分（一次性）

#### 10.3.4 回血金获取规则
- 首次发布日记：+5元
- 连续发布7天：+10元
- 抽奖中奖：根据转盘结果
- 完成年度报告：+50元
- 邀请好友注册：+20元/人

#### 10.3.5 抽奖概率配置（示例）
- 谢谢参与（0元）：50%
- 小额回血（1-5元）：30%
- 中额回血（6-20元）：15%
- 大额回血（21-100元）：4%
- 超级回血（101-1000元）：0.9%
- 巨额回血（1001-10000元）：0.1%

#### 10.3.6 留言触发条件
- 单次亏损金额 > 历史平均亏损的2倍
- 24小时内发布日记超过3次
- 连续3天发布大额亏损日记（>5000元）
- 7天内累计亏损超过10万元

### 10.4 数据更新频率
- **实时更新**：用户操作（发布、点赞、评论）、余额变化
- **准实时更新**：社区总览数据（每5分钟）
- **定时更新**：记录天数、签到状态（每日0点）
- **定期更新**：月度复盘（每月1日）、年度报告（每年1月1日）

### 10.5 关键指标定义
- **记录天数**：用户首次发布日记到当前的天数（连续计算）
- **亏损动态数**：用户发布的日记总数
- **账户总回撤比**：累计亏损 / 初始资产（如无初始资产，则用最高资产）
- **天台指数**：当日亏损用户数 / 总活跃用户数 × 当日平均亏损倍数
- **净值走势**：假设初始净值为100，每次亏损按比例减少净值

### 10.6 完整用户旅程图

```
┌─────────────────────────────────────────────────────────────┐
│                    新用户注册/登录                            │
│  - 手机号/微信登录                                            │
│  - 初始化用户数据（Lv.1, 初入江湖, 余额0）                    │
└────────────────────┬────────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────────┐
│                    新手引导                                  │
│  - 功能介绍                                                  │
│  - 引导发布第一条日记（可选）                                 │
└────────────────────┬────────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────────┐
│                  日常使用循环                                │
│                                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │ 记录亏损     │  │ 社区互动     │  │ 数据分析     │      │
│  │              │  │              │  │              │      │
│  │ 发布日记     │→ │ 浏览/点赞    │→ │ 查看复盘     │      │
│  │ 获得积分     │  │ 评论交流     │  │ 了解原因     │      │
│  │ 更新统计     │  │ 获得积分     │  │ 输入留言     │      │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘      │
│         │                 │                 │              │
│         └─────────────────┴─────────────────┘              │
│                           │                                 │
│                           ▼                                 │
│  ┌──────────────────────────────────────────┐              │
│  │        成长体系                           │              │
│  │  - 每日签到获得积分                       │              │
│  │  - 操作获得经验值                         │              │
│  │  - 等级提升解锁功能                       │              │
│  │  - 解锁勋章获得成就感                     │              │
│  └──────────────────────────────────────────┘              │
│                           │                                 │
│                           ▼                                 │
│  ┌──────────────────────────────────────────┐              │
│  │        回血活动                           │              │
│  │  - 充值参与抽奖                           │              │
│  │  - 获得回血金                             │              │
│  │  - 兑换礼品/提现                          │              │
│  └──────────────────────────────────────────┘              │
└────────────────────┬────────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────────┐
│                  年度总结                                    │
│  - 自动生成年度报告                                           │
│  - 回顾一年历程                                               │
│  - 分享成就                                                   │
│  - 制定新年目标                                               │
└─────────────────────────────────────────────────────────────┘
```

### 10.7 系统功能模块关系图

```
                    ┌─────────────┐
                    │  用户认证   │
                    │  注册/登录  │
                    └──────┬──────┘
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
        ▼                  ▼                  ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│  社区模块    │  │  个人中心    │  │  数据分析    │
│              │  │              │  │              │
│ - 首页       │  │ - 资料管理   │  │ - 复盘       │
│ - 帖子详情   │  │ - 我的日记   │  │ - 年度报告   │
│ - 发布日记   │  │ - 我的动态   │  │ - 行情分析   │
│ - 互动评论   │  │ - 勋章墙     │  │              │
│ - 通知中心   │  │ - 设置       │  │              │
└──────┬───────┘  └──────┬───────┘  └──────┬───────┘
       │                 │                 │
       └─────────────────┼─────────────────┘
                         │
        ┌────────────────┼────────────────┐
        │                │                │
        ▼                ▼                ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│  回血模块    │  │  救助站      │  │  成长体系    │
│              │  │              │  │              │
│ - 抽奖       │  │ - 额度管理   │  │ - 等级系统   │
│ - 充值提现   │  │ - 产品推荐   │  │ - 积分系统   │
│ - 回血中心   │  │ - 截图审核   │  │ - 勋章系统   │
│ - 兑换礼品   │  │              │  │              │
└──────────────┘  └──────────────┘  └──────────────┘
```

### 10.8 数据流转完整图

```
用户操作层
    │
    ├─ 发布日记 → 日记表 → 统计表 → 社区总览 → 通知表
    │
    ├─ 点赞评论 → 互动表 → 帖子统计 → 通知表 → 积分表
    │
    ├─ 抽奖充值 → 余额表 → 记录表 → 积分表 → 通知表
    │
    └─ 查看复盘 → 复盘表 ← 统计计算 ← 日记表

定时任务层
    │
    ├─ 每日0点：更新记录天数、重置签到、计算天台指数
    │
    ├─ 每周：生成周报数据
    │
    ├─ 每月1日：生成月度复盘、检查勋章解锁
    │
    └─ 每年1月1日：生成年度报告、重置年度数据

实时推送层
    │
    ├─ 互动通知（点赞、评论、回复）
    │
    ├─ 系统通知（审核结果、活动通知）
    │
    └─ 数据更新通知（等级提升、勋章解锁）
```

---

**文档版本**：v2.0  
**创建日期**：2024年  
**最后更新**：2024年  
**更新内容**：完善流程闭环，补充数据流转，增加子页面需求，完善业务规则
